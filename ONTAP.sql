CREATE DATABASE KHOHANG
CREATE TABLE HANG_HOA(
	MA_HANG NVARCHAR (3) PRIMARY KEY,
	TEN_HANG NVARCHAR (25) NOT NULL,
	MAU NVARCHAR (50) NOT NULL,
	TRONG_LUONG INT NOT NULL,
	NUOC_SAN_XUAT NVARCHAR (25) NOT NULL
)
INSERT INTO HANG_HOA
VALUES  ('H01','HÀNG 1','ĐỎ',500,'VIỆT NAM'),
		('H02','HÀNG 2','XANH',50,'TRUNG QUỐC'),
		('H03','HÀNG 3','VÀNG',900,'NHẬT'),
		('H04','HÀNG 4','TÍA',100,'THÁI LAN'),
		('H05','HÀNG 5','ĐỎ',200,'NGA'),
		('H06','HÀNG 6','ĐỎ',150,'VIỆT NAM')
CREATE TABLE NHA_CUNG_CAP(
	MA_NHA_CUNG_CAP NVARCHAR (3) PRIMARY KEY,
	TEN_NHA_CUNG_CAP NVARCHAR (25) NOT NULL,
	DIA_CHI NVARCHAR (25) NOT NULL,
	GHI_CHU XML
)
INSERT INTO NHA_CUNG_CAP
VALUES  ('C01','NHÀ CUNG CẤP 1','VIỆT NAM',''),
		('C02','NHÀ CUNG CẤP 2','TRUNG QUỐC',''),
		('C03','NHÀ CUNG CẤP 3','NHẬT',''),
		('C04','NHÀ CUNG CẤP 4','THÁI LAN',''),
		('C05','NHÀ CUNG CẤP 5','NGA',''),
		('C06','NHÀ CUNG CẤP 6','VIỆT NAM','')
CREATE TABLE XUAT_HANG(
	MA_NHA_CUNG_CAP NVARCHAR (3),
	MA_HANG NVARCHAR (3) NOT NULL,
	GHI_CHU XML,
	CONSTRAINT PK1
	PRIMARY KEY (MA_NHA_CUNG_CAP,MA_HANG)
)
INSERT INTO XUAT_HANG
VALUES  ('CO1','H01',''),
		('CO2','H02',''),
		('C03','H03',''),
		('C04','H04',''),
		('C05','H05',''),
		('CO2','H06',''),
		('CO2','H01',''),
		('CO2','H03',''),
		('CO2','H04',''),
		('CO2','H05','')
--C3--
UPDATE NHA_CUNG_CAP
SET DIA_CHI = 'HONG KONG'
WHERE TEN_NHA_CUNG_CAP = 'NHÀ CUNG CẤP 5' 
--C4--
SELECT A.TEN_NHA_CUNG_CAP,A.DIA_CHI FROM NHA_CUNG_CAP A
--C5.1--
SELECT B.TEN_HANG,B.MAU,B.TRONG_LUONG,B.NUOC_SAN_XUAT FROM HANG_HOA B
--C5.2--
SELECT B.TEN_HANG,B.MAU,B.TRONG_LUONG,B.NUOC_SAN_XUAT,A.TEN_NHA_CUNG_CAP,A.DIA_CHI FROM HANG_HOA B,NHA_CUNG_CAP A,XUAT_HANG C
WHERE (A.MA_NHA_CUNG_CAP = C.MA_NHA_CUNG_CAP) AND (B.MA_HANG = C.MA_HANG) 
--C6
SELECT A.MA_NHA_CUNG_CAP,A.TEN_NHA_CUNG_CAP FROM NHA_CUNG_CAP A
WHERE A.MA_NHA_CUNG_CAP	NOT IN (SELECT MA_NHA_CUNG_CAP FROM XUAT_HANG)

--C7
SELECT A.TEN_NHA_CUNG_CAP FROM NHA_CUNG_CAP A 
WHERE A.MA_NHA_CUNG_CAP IN (SELECT MA_NHA_CUNG_CAP FROM XUAT_HANG GROUP BY MA_NHA_CUNG_CAP HAVING COUNT(MA_HANG)>=1) 
--c8
select * from Hang_Hoa
where Mau like '%Đỏ%'
select * from Xuat_hang
select Ten_nha_cung_cap from Nha_cung_cap
where Ma_nha_cung_cap in (select Ma_nha_cung_cap
from Xuat_hang A inner join Hang_Hoa B on A.Ma_hang =B.Ma_hang
where B.Mau like '%Đỏ%'
group by Ma_nha_cung_cap having COUNT(A.Ma_hang)>=1)
--9--
SELECT A.TEN_NHA_CUNG_CAP FROM NHA_CUNG_CAP A,HANG_HOA B,XUAT_HANG C
WHERE (A.MA_NHA_CUNG_CAP = C.MA_NHA_CUNG_CAP) AND (B.MA_HANG = C.MA_HANG) AND B.MAU LIKE 'ĐỎ'
